<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DinoWorld</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <img src="logo-JP.jpg" alt="Logo del sitio" class="logo">
        </header>
        
        <!-- Main Content -->
        <main class="content">
            <h1>Bienvenidos a Jurassic World</h1>
            <p>Aquí podrás encontrar un enlace de la pelea del Therizinosaurus y T.Rex vs Giganotosaurus</p>
            <a href="https://youtu.be/Q_uFdzNteiY?si=zFS9p4UNcONHvIB6" target="_blank">Ver Video</a>
        </main>
        
        <!-- Sección de Administración -->
        <section class="admin-section">
            <h2>Administrar Dinosaurios</h2>
            
            <!-- Formulario para agregar o editar dinosaurios -->
            <form id="dinoForm">
                <input type="hidden" id="dinoId">
                <input type="text" id="nombre" name="nombre" placeholder="Nombre" required>
                <input type="text" id="especie" name="especie" placeholder="Especie" required>
                <input type="text" id="periodo" name="periodo" placeholder="Periodo" required>
                <textarea id="descripcion" name="descripcion" placeholder="Descripción"></textarea>
                <input type="text" id="imagen" name="imagen" placeholder="URL de la imagen">
                <button type="submit">Guardar</button>
            </form>
            
            <!-- Lista de dinosaurios -->
            <ul id="dinoList"></ul>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <p>Curso: Conceptualización de servicios en la nube</p>
            <p>Nombre: José Antonio Barrios Rodríguez</p>
            <p>Código: 210719887</p>
            <p>Correo: anto100.br@gmail.com</p>
        </footer>
    </div>

    <script>
        const dinoForm = document.getElementById('dinoForm');
        const dinoList = document.getElementById('dinoList');

        // Función para obtener y renderizar la lista de dinosaurios
        function fetchAndRenderDinos() {
            fetch('/api.php')
                .then(response => response.json())
                .then(data => {
                    dinoList.innerHTML = ''; // Limpiar la lista actual
                    data.forEach(dino => {
                        const li = document.createElement('li');
                        li.innerHTML = `
                            <strong>${dino.nombre}</strong> (${dino.especie}) - ${dino.periodo}
                            <p>${dino.descripcion}</p>
                            <img src="${dino.imagen}" alt="${dino.nombre}" width="150">
                            <button onclick="deleteDino(${dino.id})">Eliminar</button>
                        `;
                        dinoList.appendChild(li);
                    });
                })
                .catch(error => console.error('Error al obtener dinosaurios:', error));
        }

        // Función para manejar el envío del formulario
        function handleFormSubmit(event) {
            event.preventDefault();

            const formData = new FormData(dinoForm);
            const data = {
                nombre: formData.get('nombre'),
                especie: formData.get('especie'),
                periodo: formData.get('periodo'),
                descripcion: formData.get('descripcion'),
                imagen: formData.get('imagen')
            };

            fetch('/api.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(() => {
                dinoForm.reset(); // Limpiar el formulario
                fetchAndRenderDinos(); // Actualizar la lista de dinosaurios
            })
            .catch(error => console.error('Error al guardar dinosaurio:', error));
        }

        // Función para eliminar un dinosaurio
        function deleteDino(id) {
            fetch(`/api.php?id=${id}`, { method: 'DELETE' })
                .then(() => fetchAndRenderDinos())
                .catch(error => console.error('Error al eliminar dinosaurio:', error));
        }

        // Cargar la lista de dinosaurios al cargar la página
        document.addEventListener('DOMContentLoaded', fetchAndRenderDinos);

        // Agregar el evento de submit al formulario
        dinoForm.addEventListener('submit', handleFormSubmit);
    </script>
</body>
</html>
